[베이스, 두 달 안에 2배의 확장성 개선 계획 발표]

베이스가 잠시 멈췄던 확장성 개선 계획을 재개하겠다는 계획을 밝혔습니다. 이번엔 전보다 매우 야심차게, 두 달 안에 2배의 확장성 개선을 달성하겠다는 목표네요.

올해 초까지만 해도 베이스는 2주 혹은 한달마다 10% 혹은 20%씩 가스 리밋을 올려가며 체인의 한계를 높이겠다는 계획을 착실히 수행하고 있었습니다. 그러나, 그렇게 생성된 추가 블록스페이스는 대부분 아비트라저 봇들이 보낸 트랜잭션으로 채워졌죠.

<문제 1: 연산의 가격이 잘못되었다>

봇이든 유저든 블록스페이스를 제 값 주고 구매한다면 시퀀서 입장에선 큰 문제가 없겠으나, 문제는 이런 봇 트랜잭션들이 실제 베이스 시퀀서가 소모하는 컴퓨팅 리소스보다 적은 돈을 내고 있었다는 점입니다. EVM의 연산이 L1에 맞춰 산정되었기 때문에, 베이스는 L2 환경에 맞게 연산의 가격을 조정하여 DoS 공격 벡터를 막고, 올바른 값에 블록스페이스를 팔아야 했죠.

<문제 2: 이더리움 L1의 데이터 병목>

또한, 이더리움 단에서의 병목도 존재하였습니다. 베이스를 포함한 이더리움 롤업들은 트랜잭션 데이터를 블롭(blob)에 올리는데, 이 공간이 그리 넉넉하지 않다는 문제입니다. 지난 5월 펙트라 업그레이드를 통해 이 공간의 크기가 두 배 증가했으나, 현재 라이터(Lighter)나 월드체인 등 롤업들의 수요가 크게 증가해 다시 거의 꽉 찬 상태가 되었습니다.

<문제 3: 컴퓨팅 성능>

마지막으로, 롤업 클라이언트들의 성능 역시 이슈가 될 수 있습니다. 베이스에서 만든 벤치마크 결과를 보면 전반적으로 OP 스택에서 기본으로 쓰이는 geth의 성능은 베이스와 같은 고성능 블록체인에 적합하지 않으며, 패러다임에서 개발한 reth와 같은 클라이언트를 써야 더 높은 가스 리밋을 달성할 수 있습니다.

베이스는 이러한 이슈로 매주 혹은 매달 가스 리밋을 올리는 계획 실행을 중단하고, 지난 몇 개월 동안 다음과 같은 일들을 수행했습니다.

1/ 블롭 확장 기여

서니사이드 랩스 및 소니움을 비롯한 옵티미즘 컬렉티브와 함께 L1에 기여해 이더리움 블롭의 한계를 높이는 업그레이드를 가속화했습니다. 

이 덕분에 L2 확장성을 이론적으로 8배 증가시키는 후사카 업그레이드가 내년으로 미뤄지지 않았습니다. 후사카는 오늘 기준으로 세폴리아 및 후디 테스트넷에 성공적으로 적용되었으며, 메인넷 업그레이드는 12월 3일 수행될 예정입니다.

2/ 시퀀서를 Reth로 마이그레이션

OP 스택에서 기본적으로 사용되는 geth를 reth로 바꾸기만 해도, 베이스는 약 두 배의 확장성 개선을 얻을 수 있습니다. 

다만, Reth는 이전 히스토리를 가져오는 방식에서 비효율성이 존재하며, 이를 개선하기 위해 베이스는 OP 랩스와 함께 Reth 실행 익스텐션(ExEx)을 만들고 있습니다.

3/ TrieDB 개선

EVM 환경에서 고질적으로 확장성의 발목을 잡는 것은 상태 읽기 및 쓰기입니다. 상태를 읽거나 변경하는 모든 액션은 DB에 머클 트리에 접근해서 값을 읽거나 수정하는 방식으로 이뤄지는데, 여기에 드는 컴퓨팅 리소스가 전체 실행에서 대부분을 차지할 정도로 많습니다. 

때문에 베이스는 이를 위한 특화 데이터베이스를 구축해, 읽기/쓰기의 효율을 10배 가량 증가시키는 걸 목표로 하고 있습니다.

4/ 리소스 가격 재편

위에서 이야기했듯이, 리소스 가격과 관련해서 베이스는 고칠 것들이 꽤 많습니다. 이는 EVM 전체를 뜯어고쳐야 할 수 있는 큰 작업이기 때문에, 베이스는 이에 대해 천천히 문제가 되는 부분부터 고쳐나가고 있습니다. 

대표적인 예가 데이터 가용성(DA)입니다. 현재 OP 스택은 L1 블롭 비용이 급등할 경우, 블록 크기를 제한하고 대용량 트랜잭션 처리를 지연하는 ‘쓰로틀링(throttling)’ 메커니즘을 통해 스팸을 방지하고 있습니다. 그러나 이 방식은 우선순위 수수료 급등 등 수수료 시장 왜곡이라는 부작용을 초래했죠.

이를 개선하기 위해, 데이터 사용량이 많은 블록이 지속될 경우 기본 수수료를 자동으로 인상하도록 가스비 계산 방식을 조정하는 업그레이드가 곧 베이스에 적용될 예정입니다. 이를 통해 DA 혼잡 시에도 수수료 시장이 자율적으로 안정화되고, 공정한 수수료 책정과 스팸 완화 효과를 동시에 기대할 수 있습니다.

5/ 병렬 검증 활성화

이더리움의 글램스터담 업그레이드에 포함된 블록 레벨 접근 리스트(Block-level Access List, BAL)는 블록 내 트랜잭션들이 접근하는 상태 정보를 블록에 포함해, 블록을 받아보는 노드들이 병렬로 트랜잭션을 실행할 수 있도록 합니다. 

베이스는 OP 랩스와 함께 이러한 솔루션을 L2에 적용하는 방향을 연구하기 시작했으며, 현재 이를 플래시블록 단위에 적용하려고 리서치를 진행 중인 것으로 보이네요.

6/ 증명 시스템

올해 초 OP 랩스는 자체 옵티미스틱 결함 증명 솔루션에 멀티스레딩과 64비트 아키텍처를 적용해 확장성을 크게 증가시켰습니다. 이 덕분에 증명 시스템이 병목이 되는 일은 당분간 없을 예정이라고 하네요.

대신 베이스도 더 나은 탈중앙화를 위해 ZK 기반 증명 시스템을 리서치 중이라고 합니다. Stage 2를 달성하기 위해서는 여러 개의 증명 시스템을 쓰는 멀티 프루프 시스템을 도입하는 것이 가장 리즈너블하며, 이를 위한 노력의 일부이지 않을까 조심스레 추측해봅니다.

이를 기반으로 베이스는 올해 Q4까지 블록 가스 리밋을 300M, 초당 150M 가스를 달성하려고 합니다. 이는 단순 ETH 전송만으로 7,142 TPS를 달성할 수 있는 수치입니다.

롤업 중 가장 높은 트래픽을 기반으로 베이스는 L2 스케일링을 이끌어나가고 있습니다. 이러한 확장성을 기반으로, 베이스가 어떠한 사용 사례를 만들어낼지 기대되네요!

출처