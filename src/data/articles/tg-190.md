Uniswap v4와 v3의 주요 차이

1. 구조 개선 (Pool Creation)

- v4: 하나의 컨트랙트로 모든 풀을 관리해서 비용 절감

- v3: 풀마다 새로운 컨트랙트를 만들어서 비용이 많이 듦

2. 거래 처리 방식 (Flash Accounting)

- v4: 여러 거래를 한꺼번에 묶어서 처리 가능 (마지막에 한 번만 정산)

- v3: 거래마다 매번 정산 필요

3. 수수료 관리 (Liquidity Fee Accounting)

- v4: 수수료를 더 효율적으로 관리. 같은 범위의 포지션도 구분 가능

- v3: 같은 범위의 포지션이 수수료를 공유해서 관리가 복잡

4. ETH 처리

- v4: ETH를 직접 사용 가능

- v3: ETH를 WETH로 먼저 변환해야 함

5. 구독자 기능

- v4: 포지션 소유자가 구독자 컨트랙트를 설정할 수 있음. 유동성이나 소유권이 변경될 때마다 이 컨트랙트에 자동 알림. 스테이킹/유동성 마이닝 시 NFT를 이전할 필요 없어 더 안전

- v3: 스테이킹을 위해서는 ERC-721 토큰(NFT)을 스테이킹 컨트랙트로 이전해야 함. 악의적인 컨트랙트의 경우 기초자산이 위험에 노출될 수 있음

유니스왑 v4는 Flash Accounting, ERC-6909, Hooks, Subscribers, Poolmanager, Dynamic Fees 등의 개념을 도입하여 전반적으로 비용 절감, 효율성, 안전성이 개선될 예정