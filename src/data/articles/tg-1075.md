네더마인드가 흥미로운 ZK 벤치마크 결과를 공개했습니다.

[배경 설명: 이더리움의 리소스 책정 방식]

현재 이더리움은 블록 검증 방식을 기존의 ‘재실행(re-execution)’ 기반에서 ‘ZK 증명 검증’ 기반으로 전환하려는 흐름에 있습니다. 이때 중요한 전제는, 블록에 포함된 모든 연산이 정해진 시간(예: 12초 블록 타임) 안에 ZK 증명을 생성할 수 있을 만큼 가벼워야 한다는 점입니다. 만약 블록 A에 ZK 증명 생성에 특히 오래 걸리는 연산들이 다수 포함되어 있어 제시간에 증명이 완성되지 못한다면, 해당 블록은 정상적으로 검증되지 못하고 체인에 포함되는 데 문제가 생길 수 있습니다.

이를 위해선 zkVM 자체의 성능 개선도 중요하지만, 그보다 더 근본적인 요소가 있습니다. 바로 ‘리소스의 가격 책정 방식’입니다. 현재 이더리움의 가스 모델은, 각 EVM 연산이 로컬 노드에서 실행될 때 드는 계산 리소스 비용을 기준으로 설계되어 있습니다. 그러나 ZK로 패러다임이 바뀌게 되면, 연산 비용은 ‘ZK 증명 생성에 얼마나 부담을 주는가’를 기준으로 재정의되어야 합니다.

[네더마인드의 벤치마크: SP1과 RISC0에서 ZK 증명 생성 비용 비교]

이번 네더마인드의 리서치는 각 EVM 연산의 비용을 ZK 증명 생성 관점에서 벤치마크하였습니다. 기존 이더리움 재단의 벤치마크 방식과 달리, 다른 변수들을 최대한 고정한 상태에서 특정 연산의 횟수만 변화시키고, 그에 따른 증명 시간 변화를 선형 회귀로 분석하는 방법을 통해, 보다 정확한 결과를 도출하려 했다는 점이 특징이라고 볼 수 있겠네요.

연구는 SP1과 RISC0의 작년 11월 릴리즈 버전을 기준으로, 각 연산이 “가스 1당 얼마나 많은 증명 생성 시간을 요구하는지”를 분석했습니다. 여기서 가스 대비 증명 시간이 높다는 것은, 해당 연산이 ZK prover의 자원을 많이 소모한다는 뜻이며, ZK 관점에서는 그 연산의 가스 가격이 상대적으로 과소평가되어 있다는 신호로 해석할 수 있습니다.

[결과: SP1 >> RISC0?]

ZK 증명 생성 비용이 가장 높은 연산은 MODEXP로 나타났습니다. 후사카 업그레이드에서 이미 가스 가격이 인상되었음에도 불구하고, 가스 단위당 증명 생성 시간은 SP1과 RISC0 모두에서 여전히 가장 높은 수준을 보였습니다. 즉, ZK 환경에서는 MODEXP는 여전히 매우 무거운 연산입니다.

그 다음으로 비용이 큰 연산들은 zkVM 종류에 따라 차이를 보였습니다. SP1과 RISC0 간 가장 큰 성능 격차를 보인 연산은 이더리움의 해시 연산인 keccak256으로, RISC0가 SP1보다 약 12.7배 느린 것으로 측정되었습니다. 이는 SP1이 ZK에 친화적이지 않은 연산을 전용 회로(프리컴파일 구조)로 분리해 처리하는 구조를 갖고 있고, keccak은 프리컴파일로 처리되는 연산이라 빠르게 처리될 수 있습니다. 반면 RISC0는 이러한 연산을 보다 범용적인 방식으로 처리해 증명 비용이 크게 늘어난 것으로 보입니다.

이 외에도 대부분의 연산에서 SP1이 RISC0보다 더 낮은 증명 비용을 보였습니다. 연산 단위로 분해해 비교한 벤치마크이므로, 단순한 GPU 클러스터 등의 셋업 차이보다는 zkVM 설계의 차이가 성능 차이의 주된 원인으로 볼 수 있을 것 같네요. 즉 작년 11월 기준 릴리즈 버전에서는, SP1이 RISC0에 비해 전반적으로 더 좋은 성능을 보였다고 정리할 수 있을 것 같습니다.

[이 결과가 의미하는 것: 가스 모델은 어떻게 바뀔 수 있을까?]

이번 결과가 시사하는 바는 꽤 명확합니다. 지금의 가스 모델은 ‘연산이 실행 환경에서 얼마나 무거운가’를 기준으로 설계되어 있지만, ZK 중심 구조에서는 ‘연산이 ZK 증명 환경에서 얼마나 무거운가’가 더 중요한 기준이 됩니다. 그런데 이번 벤치마크는 이 두 관점이 상당히 다르다는 점을 보여줍니다.

이런 상황이 지속된다면, 가스 한도는 지켜졌지만 증명 시간이 과도하게 늘어나는 ‘ZK 기준의 비정상 블록’이 등장할 수 있습니다. 이는 프로버에 대한 사실상의 DoS 벡터가 될 수 있고, 장기적으로는 실시간 증명 기반 체인 운영을 어렵게 만들 수 있습니다.

따라서 앞으로의 가스 모델은 연산별 ZK 증명 비용을 반영한 새로운 지표를 함께 고려하는 방향으로 재편될 가능성이 큽니다. 이번 네더마인드의 연구는 어떤 연산이 ZK 관점에서 특히 위험한지, 어디에서 병목이 생기는지를 수치로 보여주기 때문에, 앞으로의 가스 가격 책정 논의와 zkVM 설계 최적화 모두에 중요한 참고점이 될 수 있을 것으로 보이네요.

출처